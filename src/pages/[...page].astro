---
import type { GetStaticPaths } from "astro";
import Pagination from "../components/control/Pagination.astro";
import PostPage from "../components/PostPage.astro";
import { PAGE_SIZE } from "../constants/constants";
import MainGridLayout from "../layouts/MainGridLayout.astro";
import { getSortedPosts } from "../utils/content-utils";

export const getStaticPaths = (async ({ paginate }) => {
    const allBlogPosts = await getSortedPosts();
    return paginate(allBlogPosts, { pageSize: PAGE_SIZE });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
const len = page.data.length;

// åˆ¤æ–·æ˜¯å¦ç‚ºç¬¬ä¸€é  (é¦–é )
const isFirstPage = page.url.current === '/' || page.url.current === '';
---

<MainGridLayout>
    {isFirstPage && (
        <div class="flex flex-col items-center justify-center min-h-[60vh] text-center mb-12 onload-animation">
            <div class="relative group mb-6">
                <div class="absolute -inset-1 bg-gradient-to-r from-[var(--primary)] to-purple-600 rounded-full blur opacity-25 group-hover:opacity-50 transition duration-1000"></div>
                <img src="/avatar.png" class="relative w-32 h-32 rounded-full border-4 border-white dark:border-zinc-900 shadow-2xl mx-auto object-cover" alt="Avatar" />
            </div>
            <h1 class="text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-black to-zinc-500 dark:from-white dark:to-zinc-400">
                Chi Tsai
            </h1>
            <div class="text-xl text-neutral-500 dark:text-neutral-400 h-8 font-mono">
                <span id="hero-typewriter"></span>
            </div>
        </div>
    )}

    <PostPage page={page}></PostPage>
    <Pagination class="mx-auto onload-animation" page={page} style={`animation-delay: calc(var(--content-delay) + ${(len)*50}ms)`}></Pagination>
</MainGridLayout>

{isFirstPage && (
    <script>
        import TypeIt from "typeit";
        new TypeIt("#hero-typewriter", {
            speed: 70,
            startDelay: 500,
            loop: true,
        })
        .type("æŠ€è¡“å®…æ‹¯æ•‘ä¸–ç•Œ ğŸš€")
        .pause(1500)
        .delete()
        .type("ç†±æ„› iOS & Android å®¢è£½åŒ–")
        .pause(1500)
        .delete()
        .type("æ­¡è¿ä¾†åˆ°æˆ‘çš„å€‹äººç©ºé–“")
        .pause(1500)
        .delete()
        .go();
    </script>
)}